function XYZ = cams_to_3d( P1, P2, uv1, uv2 )
% % % function:
% % % cams_to_3d( P1, P2, uv1, uv2 )
% % % 
% % % example:
% % %     cams_to_3d( K*[R1, [10, 20, 25]'], K*[R2, [20, 15, 18]'], uv1(:,1), uv2(:,1) )

%%

P = P1;
u = uv1(1);
v = uv1(2);
A = [
P(3,1)*u-P(1,1), P(3,2)*u-P(1,2), P(3,3)*u-P(1,3), P(3,4)*u-P(1,4)
P(3,1)*v-P(2,1), P(3,2)*v-P(2,2), P(3,3)*v-P(2,3), P(3,4)*v-P(2,4)
];

P = P2;
u = uv2(1);
v = uv2(2);
A = [
    A
P(3,1)*u-P(1,1), P(3,2)*u-P(1,2), P(3,3)*u-P(1,3), P(3,4)*u-P(1,4)
P(3,1)*v-P(2,1), P(3,2)*v-P(2,2), P(3,3)*v-P(2,3), P(3,4)*v-P(2,4)
];

XYZ = A(:,1:3)\( -A(:,4) );